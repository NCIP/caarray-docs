USER STORY: Parse Agilent xml aCGH array designs

As a Curator or Data Owner, I want to import an Agilent aCGH array design in "GEML pattern file" (xml) format so that the array design can be associated to experiments and data files.

1. Flow:

* The user (Curator or Data Owner) chooses to import a new array design.
* The system allows "Agilent GEML/xml" as one of the options for the file type.
* The user chooses the Agilent GEML/xml format and selects a file in that format.
* The system parses the file:
  + The GEML pattern file is an xml file that contains one "reporter" element for each array feature.
  + Each "reporter" element in turn contains a "feature" element and a "gene" element. E.g.,
    <reporter name="A_16_P21312612" systematic_name="chr22:31470152-31470211" active_sequence="TAGAGAACAAACAACTCTATGAACGTGTTTACCAGAAGTTTAAGCAAATCTCTTTCCCTC" start_coord="0">
      <feature number="16321">
        <position x="1.7597636204899776" y="0.0" units="mm"></position>
      </feature>
      <gene systematic_name="chr22:31470152-31470211" primary_name="SYN3" description="ref|Homo sapiens synapsin III (SYN3), transcript variant IIIa, mRNA.">
        <accession database="ref" id="NM_003490"></accession>
        <accession database="ref" id="NM_133633"></accession>
        <other name="accessions" value="ref|NM_003490|ref|NM_133633"></other>
        <other name="probe_mappings" value="chr22:31470152-31470211"></other>
        <other name="tm" value="79.85"></other>
        <other name="IsHomFiltered" value="0"></other>
        <other name="NumPMHits" value="1"></other>
      </gene>
    </reporter>
  + For each "feature" element, the system creates a Feature object. The Agilent GEML format defines floating point "x" and "y" coordinates for each feature instead of integer column, row, block column and block row numbers. The domain model will have to be augmented to allow x and y coordinates for a Feature, and also a feature number.
  + For each unique "reporter", the system creates a PhysicalProbe. (The probe name/identifier is in the "name" attribute of the "reporter" element. ("A_16_P21312612" in the above example.)
  + The same PhysicalProbe may be repeated at multiple feature locations.
  + The probe name/identifier must always be non-empty, except for the case where the reporter's control_type attribute is set to "ignore".
  + If control_type=ignore, then the probe name may be empty or "NA*". E.g.,
    <reporter control_type="ignore" name="NA" start_coord="0">
      <feature number="6035">
        <position x="10.668" y="2.5663219465478875" units="mm"></position>
      </feature>
    </reporter>
  + All probes with control_type="pos" should be grouped into a "positive controls" probe group, all probes with control_type="neg" should be grouped into a "negative controls" probe group, and all probes with control_type="ignore" should be grouped into an "ignore" probe group.
  + Probe annotations are available in the "gene" elements.
  + The control probes don't have any annotation. (reporter elements with control_type="pos" or "neg")
  + A non-control probe may have annotations describing its accession number in 0 or more of the following databases: ref, ens (Ensembl), gb (GenBank) and thc. In addition, the same probe may be mapped to multiple accession numbers in the same database. E.g.,
      <gene systematic_name="chr2:127680689-127680748" primary_name="AK131190" description="gb|Homo sapiens cDNA FLJ16008 fis, clone NT2NE2000390, weakly  similar to 25-HYDROXYVITAMIN D-1 ALPHA HYDROXYLASE, MITOCHONDRIAL PRECURSOR (EC 1.14.-.-).">
        <accession database="gb" id="AK131190"></accession>
        <other name="accessions" value="gb|AK131190"></other>
        <other name="probe_mappings" value="chr2:127680689-127680748"></other>
        <other name="tm" value="80.7"></other>
        <other name="IsHomFiltered" value="0"></other>
        <other name="NumPMHits" value="1"></other>
      </gene>
  + The system stores the gene and chromosome information in ExpressionProbeAnnotation.
  + The system stores the first GenBank accession number in ExpressionProbeAnnotation->Gene.genbankAccession.
  + The system stores the first Ensembl accession number in ExpressionProbeAnnotation->Gene.ensemblgeneID.
  + The model needs to be augmented to store other accession numbers. Suggest making this generic by allowing a number of accession + database combinations. (These would store additional GenBank accession numbers, additional Ensembl accession numbers, and also other accession numbers we find in the array design file - e.g., from databases "ref" and "thc".)
  + The chromosome number, start position and end position is parsed from the <other name="probe_mappings" value="chr2:127680689-127680748"></other> element. Suggest adding chromosome information to ExpressionProbeAnnotation: chromosome number (1-22, X, Y), long startPosition, long endPosition.
* Note: There is already some chromosome information in SNPProbeAnnotation, but that has a single number for physicalPosition, since it refers to the position of a single allele. It also has a flank / strand direction (+/-). ExonProbeAnnotation, on the other hand, has a "start", "stop" and "strand". We should probably standardize and consolidate all of the chromosome information for probes in a parent class.
* The import fails if the file fails any of the validation rules above.
* If the import passes, the features, probes and probe groups are successfully stored in the database.

3. Example files:

Sample Agilent GEML/xml files are under agilent/example_files/array_design/aCGH/*.xml.
